<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="Description" content="HIPI - Hadoop Image Processing Interface experimental results to test the efficacy of the distributed image processing sytem." />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    
    <link rel="stylesheet" type="text/css" href="include/main.css" />
    <link rel="stylesheet" type="text/css" href="include/javasyntax.css" />
    <title>HIPI - Hadoop Image Processing Interface :: Experiment Results</title>

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23539446-1']);
      _gaq.push(['_trackPageview']);
      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>

    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
    <style> pre.prettyprint {padding:20px 20px 0px 20px;} </style>
  
  </head>
  
  <body>
    <div class="header">
      <h1>HIPI - Hadoop Image Processing Framework</h1>
    </div>
    <div class="navigation_menu">
      <ul>
	<li><a href="index.html">Overview</a></li>
	<li><a href="gettingstarted.html">Getting Started</a></li>
	<li><a href="documentation.html">Documentation</a></li>
	<li><a href="examples.html">Tools and Examples</a></li>
	<li><a href="downloads.html">Downloads</a></li>
	<li><a href="contribute.html">Contribute</a></li>
	<li><a href="about.html">About</a></li>
      </ul>
    </div>
    
    <!-- Begin Content -->
    <div class="content">
      
      <h2 class="title">Experiments</h2>

      <div class="section">

      We performed several experiments designed to measure the efficiency of the HIPI framework as compared to several alternatives. These experiments were performed using a cluster provided by the National Science Foundation, Google, and IBM through the <a class="external_link" href="http://www.nsf.gov/cise/clue/index.jsp">Cluster Exploratory (CluE) program</a>. The machines in this cluster each contained seven Intel Xeon 64-bit processors running at 2.8 GHz with 8 GB of shared memory. Altogether, this cluster provided 416 compute nodes that could execute 834 map operations in parallel and 830 reduce operations in parallel. This cluster was running Apache Hadoop version 0.20.0.

      <h3>HIB Experiment</h3>

	This experiment was designed to study the performance of the <a href="doc/api/hipi/imagebundle/HipiImageBundle.html">HipiImageBundle</a> (HIB) versus three common alternatives: storing images as individual files on the HDFS, using an Apache <a class="external_link" href="http://hadoop.apache.org/common/docs/r0.20.1/api/org/apache/hadoop/io/SequenceFile.html">SequenceFile</a>, or using the Apache Hadoop Archives (or HAR) <a class="external_link" href="http://hadoop.apache.org/common/docs/r0.20.1/api/org/apache/hadoop/fs/HarFileSystem.html">file system</a>. We measured the running time of a MapReduce program that essentially performs a "nop" (empty map and reduce tasks) in order to measure the amount of time it takes to simply read and decoding the images from the HDFS and present them to the mapper. The following graph plots measured wall clock running time in seconds (y-axis) as a function of the number of input images (x-axis) for these different representations. (See above for description of the cluster that was used to take these measurements.)

	<img class="centered_image" src="images/experiments/empty-perf.png" alt="" />

	Note that attempting to process 10,000 individual files or more resulted in a MapReduce setup phase that timed out. Also, note that HIBs provide significant advantages over many small files and the Hadoop Archive filesystem, although Hadoop sequence files offer more competitive performance. HIPI includes the <a href="doc/api/hipi/imagebundle/SeqImageBundle.html">SeqImageBundle</a> class that facilitates creating Hadoop sequence files from image collections.

      <h3>Covariance Experiment</h3>

	We also measured the performance of using many individual files, a Hadoop Sequence File, or a HipiImageBundle (HIB) in conjunction with the distributed <a href="examples/pca.html">Principal Components of Patches</a> example program. This experiment reflects a more realistic computational load in the map and reduce layers. The running time for each input type is reported in seconds along the y-axis as a function of input size (number of images) along the x-axis:

	<img class="centered_image" src="images/experiments/cov-perf.png" alt="" />

      The many small files approach was not able to support more than 100 images for this more computationally intensive program. Also, Hadoop Sequence Files and HIBs provided comparable performance.

      <h3>Culling Experiment</h3>

	HIPI's <a href="doc/api/hipi/imagebundle/mapreduce/CullMapper.html">CullMapper</a> class is a useful extension of the Hadoop <a class="external_link" href="http://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Mapper.html">Mapper</a> class that allows a MapReduce program to efficiently skip images that do not meet a particular set of criteria. In this experiment, we measured the time taken to compute the average image captured using a Canon PowerShot S500 digital camera with a resolution of 2592x1944 from a collection of images downloaded from Flickr. Here is the <tt>cull()</tt> method that achieves this goal:

      <pre class="prettyprint">
public static class MyMapper extends CullMapper&#60;ImageHeader, FloatImage, NullWritable, FloatImage&#62; {       

  public boolean cull(ImageHeader key) throws IOException, InterruptedException {
    if (key.getEXIFInformation("Model").equals("Canon PowerShot S500") &amp;&amp; key.width == 2592 &amp;&amp; key.height == 1944) {
      return false;
    } else {
      return true;
    }
  }
  ...
	</pre>

	The following graph plots the running times (in seconds, along y-axis) as a function of the input size (in number of images, along x-axis) for different input sizes:

	<img class="centered_image" src="images/experiments/cull-perf.png" alt=""/>

	Note that culling provides a small improvement in performance. The specific degree of improvment is, naturally, a matter of how many images in the HIB meet the culling criteria.

      </div>
    </div>
    <!-- End Content -->
  </body>
</html>
  
